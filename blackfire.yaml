package:
  name: blackfire
  version: 2.28.27
  epoch: 0
  description: "Blackfire CLI"
  copyright:
    - license: PROPRIETARY
  options:
    no-provides: true

environment:
  contents:
    packages:
      - bash
      - busybox
      - curl

pipeline:
  - uses: fetch
    if: ${{build.arch}} == 'x86_64'
    with:
      uri: https://blackfire.io/api/v1/releases/cli/linux/x86_64
      expected-sha512: 99442b23238d31c3c6a8a525d071569b665251fd27903f8d9f118273cee0b7f7f9ec598e5ef4ab54e2bd31732e99a3b95576bb76d28e909f97f4d21745b76c78

  - uses: fetch
    if: ${{build.arch}} == 'aarch64'
    with:
      uri: https://blackfire.io/api/v1/releases/cli/linux/aarch64
      expected-sha512: a5219047b77425a25e089dc2fd3bde5b45c1ea1d00b58cfe604e1a722a394b8a29cdb780d02cf9b2e85ce9faa92380199b9936e06f74b6a9cc3f182b81e14770

  - runs: |
      tar xfv ${{build.arch}}
      mkdir -p ${{targets.destdir}}/usr/bin
      mv blackfire ${{targets.destdir}}/usr/bin/

update:
  enabled: true
  release-monitor:
    identifier: 372834

test:
  pipeline:
    - runs: |
        blackfire version
